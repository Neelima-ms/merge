name: Automerge

on:
 push:
     branches:
       - release/*

env:
  MY_REPO: https://github_username:${{secrets.GITHUB_TOKEN}}@github.com/mydevopsgithub/merge
  MY_BRANCH: master
  MASTER_REPO: https://github.com/mydevopsgithub/merge
  MASTER_BRANCH: release/*

jobs:
  merge:
    runs-on: ubuntu-latest

    steps:
    - name: Merge release branch to default branch
      run: |
        git clone ${{env.MY_REPO}} -b ${{env.MY_BRANCH}} tmp
        cd tmp
        git config user.name "mydevopsgithub"
        git config user.email "neelimamaddela95@gmail.com"
        git config pull.rebase false
        git pull ${{env.MASTER_REPO}} ${{env.MASTER_BRANCH}}
        git push
        
#     - name: Send email using sendGrid
#       uses: peter-evans/sendgrid-action@v1
#       env:
#         SENDEGRID_API_KEY: ${{ secrets.SENDGRID_API_KEY }}
#       with:
#         subject: "Merge Conflicts Notification"
#         to: neelimamddela95@gmail.com
#         text: "There are conflicts detected when merging branches"
        
